<full code already in canvas>